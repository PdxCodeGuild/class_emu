<!-- JavaScript lab filename: lab01_v5_grading.py -->

<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS lab 01: Grading - v5</title>
    <style type="text/css" media="screen">
      .question_answer {
        font-size: 24px;
        padding: 15px 0;
        width: 50%;
        margin: auto;
        text-align: center;
        vertical-align: middle;
      }
      #input_user_number {
        height: 30px;
        font-size: 22px;
        vertical-align: middle;
      }
      #button_run {
        background-color: #C0C0C0;
        border: 1px solid #333;
        box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
        font-size: 24px;
        margin: auto;
        padding: auto;
        text-decoration: none;
        vertical-align: middle;
      }
      #button_run:active{
        box-shadow: none;
      }
      button_run: {
        outline: 0;
      }
      #span_result {
        font-size: 24px;
      }
    </style>
  </head>
  <body>
    <div>
      <h1>Lab 3: Grading</h1>
      <h3>Let's convert a number grade to a letter grade, using if and elif statements and comparisons.</h3>
    </div>
    <div><u>Instructions</u>:</div>
    <div>
      <ol>
        <li>Have the user enter a number representing the grade (0-100)</li>
        <li>Convert the number grade to a letter grade</li>
        <li>
          <span>Numeric Ranges:</span>
          <ul>
            <li>90-100: A</li>
            <li>80-89: B</li>
            <li>70-79: C</li>
            <li>60-69: D</li>
            <li>0-59: F</li>
          </ul>
        </li>
      </ol>
    </div>
    <span><b>v5: Allow user to hit Enter button to get the result; improved error handling; replaced part of if/else logic with <i>for</i> loop; improved unit tests, specifically the <i>expected_out_input_obj</i></b></span>
    <hr/>
    <div class="question_answer">
      <span>Enter a number between 0 and 100: <input type="text" id="input_user_number"/>
      <button id="button_run">Run the lab</button>
      </span>
    </div>
    <div class="question_answer"><span><u>Result</u>: </span><span id="span_result"></span></div>

    <script type="text/javascript">
      let input_user_number = document.querySelector('#input_user_number')
      let button_run = document.querySelector('#button_run')
      let span_result = document.querySelector('#span_result')

      let data_matrix = {
        0:[90,101,'You got an A! Great job!!','A'],
        1:[80,90,'You got a B! Good job!','B'],
        2:[70,80,'You got a C. Not bad.','C'],
        3:[60,70,'You got a D. Did you study?','D'],
        4:[0,60,'That\'s an F. D\'oh!','F'],
        5:[Number.NEGATIVE_INFINITY,0,'That number is less than zero!','tooLow'],
        6:[101,Number.POSITIVE_INFINITY,'That number is too high!','tooHigh']
      }

      function evalGrade(user_number) {
        if (user_number == '') {
            span_result.innerText = 'You didn\'t enter anything.'
            return 'blank'
        } else if (isNaN(user_number)) {
            span_result.innerText = 'You didn\'t enter a number.'
            return 'NaN'
        } else {
            for (let i=0;i<Object.keys(data_matrix).length;++i) {
              let t_input_array = data_matrix[i]
              let t_input_lower = t_input_array[0]
              let t_input_upper = t_input_array[1]
              let t_output_msg = t_input_array[2]
              let t_return_value = t_input_array[3]
                  if (user_number >= t_input_lower && user_number < t_input_upper) {
                      span_result.innerText = t_output_msg
                      if (i < 5) {
                        document.querySelector('#input_user_number').value = ''
                      }
                      return t_return_value
                  }
            }
        }
      }

      // Execute evalGrade() when the user presses a key on the keyboard
      input_user_number.addEventListener("keydown", function (event) {
          if (event.keyCode === 13) {
              button_run.click()
          }
      })
      // Get value from text input field and submit it to the evalGrade()
      button_run.onclick = function() {
        let user_number = input_user_number.value
        evalGrade(user_number)
      }

/* Hide this line ( e.g. Atom: cmd+/) to run the tests; check console
      // ### UNIT TESTS ### //
      let input_expected_out_obj = {
        0:['','blank'],
        1:['letters','NaN'],
        2:['101','tooHigh'],
        3:['-1','tooLow'],
        4:['100','A'],
        5:['95','A'],
        6:['90','A'],
        7:['89','B'],
        8:['85','B'],
        9:['80','B'],
        10:['79','C'],
        11:['75','C'],
        12:['70','C'],
        13:['69','D'],
        14:['65','D'],
        15:['60','D'],
        16:['59','F'],
        17:['55','F'],
        18:['1','F'],
        19:['0','F'],
        20:[0,'blank']    // the number 0 is a falsey statement
      }
      let test_fail_count = 0
      for (let i=0;i<Object.keys(input_expected_out_obj).length;++i) {
        let test_data_properties = input_expected_out_obj[i]
        let function_input = test_data_properties[0]
        let expected_output = test_data_properties[1]
        let actual_result = evalGrade(function_input)
        if (actual_result != expected_output) {
          console.log(`${i} Fail -- expected: ${expected_output} : actual: ${actual_result}`)
          ++test_fail_count
        }
      }
    if (test_fail_count === 0) {
      console.log("All tests passed.")
    }
// */
    </script>
  </body>
</html>
